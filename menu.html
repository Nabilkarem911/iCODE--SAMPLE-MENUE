<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ù†ÙŠÙˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* ğŸ¨ Ù‡Ù†Ø§ Ø§Ù„Ø³Ø±: Ø¨Ù†Ø¹Ø±Ù Ù…ØªØºÙŠØ± Ø§Ø³Ù…Ù‡ --primary */
        :root { --primary: #FF9F1C; } 
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; padding-bottom: 100px; }
        
        /* Ø¨Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ØªØºÙŠØ± Ø¯Ù‡ ÙÙŠ Ø§Ù„ÙƒÙ„Ø§Ø³Ø§Øª Ø§Ù„Ø®Ø§ØµØ© */
        .btn-primary { background-color: var(--primary); color: white; }
        .text-primary { color: var(--primary); }
        .border-primary { border-color: var(--primary); }
        .bg-primary-light { background-color: var(--primary); opacity: 0.1; }
    </style>
</head>
<body class="bg-gray-50">

    <div id="loader" class="fixed inset-0 bg-white z-50 flex items-center justify-center"><div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div></div>

    <div class="bg-white p-4 sticky top-0 z-40 shadow-sm flex justify-between items-center">
        <div><h1 id="m-name" class="font-black text-xl">...</h1></div>
        <img id="m-logo" src="images/logo.png" class="w-10 h-10 rounded-lg bg-gray-50 object-contain p-1">
    </div>

    <div id="cats-box" class="flex gap-2 overflow-x-auto p-4 sticky top-[70px] z-30 bg-white/95 backdrop-blur border-b"></div>

    <div id="menu-box" class="p-4 space-y-4 min-h-screen"></div>

    <script type="module">
        import { db, doc, getDoc } from './firebase-config.js';
        const restId = new URLSearchParams(window.location.search).get('id');

        async function init() {
            if(!restId) return;
            const snap = await getDoc(doc(db, "restaurants", restId));
            if(snap.exists()) {
                const data = snap.data();
                document.getElementById('m-name').innerText = data.name;
                document.getElementById('m-logo').src = data.logo;
                
                // ğŸ¨ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø³Ø­Ø±ÙŠ: ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„
                if(data.themeColor) document.documentElement.style.setProperty('--primary', data.themeColor);

                renderMenu(data.products || []);
            }
            document.getElementById('loader').style.display = 'none';
        }

        function renderMenu(list) {
            const box = document.getElementById('menu-box');
            if(list.length===0) return box.innerHTML = "<p class='text-center text-gray-400'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>";
            box.innerHTML = `<div class="grid grid-cols-2 gap-4">` + list.map(p => `
                <div class="bg-white rounded-2xl shadow-sm border overflow-hidden">
                    <img src="${p.image}" class="h-32 w-full object-cover" onerror="this.src='images/logo.png'">
                    <div class="p-3">
                        <h3 class="font-bold text-sm mb-1 line-clamp-1">${p.name}</h3>
                        <div class="flex justify-between items-center">
                            <span class="font-black text-primary">${p.price} Ø±.Ø³</span>
                            <div class="w-6 h-6 rounded-full flex items-center justify-center font-bold" style="background-color: var(--primary); color: white;">+</div>
                        </div>
                    </div>
                </div>`).join('') + `</div>`;
        }
        init();
    </script>
</body>
</html>
